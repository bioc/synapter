<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Fragment matching using <em>synapter</em> • synapter</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.7.1/clipboard.min.js" integrity="sha384-cV+rhyOuRHc9Ub/91rihWcGmMmCXDeksTtCihMupQHSsi8GIIRDG0ThDc3HGQFJ3" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Fragment matching using &lt;em&gt;synapter&lt;/em&gt;">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">synapter</a>
        <span class="label label-default" data-toggle="tooltip" data-placement="bottom" title="Released package">2.5.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/synapter.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/fragmentmatching.html">Fragment matching using *synapter*</a>
    </li>
    <li>
      <a href="../articles/synapter2.html">Synapter2 and synergise2</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Fragment matching using <em>synapter</em>
</h1>
                        <h4 class="author">Laurent Gatto</h4>
            <address class="author_afil">
      Computational Proteomics Unit, Cambridge, UK.<br><h4 class="author">Sebastian Gibb</h4>
            <address class="author_afil">
      Department of Anesthesiology and Intensive Care, University Medicine Greifswald, Germany.<br><h4 class="author">Pavel V. Shliaha</h4>
            <address class="author_afil">
      Department of Biochemistry and Molecular Biology, University of Southern Denmark, Denmark.<br><div class="hidden name"><code>fragmentmatching.Rmd</code></div>

    </address>
</address>
</address>
</div>

    
        <div class="abstract">
      <p class="abstract">Abstract</p>
      <p>This vignette describes how to apply fragment matching to MS<span class="math inline">\(^E\)</span>/HDMS<span class="math inline">\(^E\)</span> data using the ‘synapter’ package. The fragment matching feature allows one to rescue non unique matches and remove falsely assigned unique matches as well.</p>
    </div>
    
<div id="foreword" class="section level1 unnumbered">
<h1 class="hasAnchor">
<a href="#foreword" class="anchor"></a>Foreword</h1>
<p><a href="http://bioconductor.org/packages/synapter"><em>synapter</em></a> is free and open-source software. If you use it, please support the project by citing it in publications:</p>
<blockquote>
<p>Nicholas James Bond, Pavel Vyacheslavovich Shliaha, Kathryn S. Lilley, and Laurent Gatto. <em>Improving qualitative and quantitative performance for MS<span class="math inline">\(^E\)</span>-based label free proteomics.</em> J. Proteome Res., 2013, 12 (6), pp 2340–2353</p>
</blockquote>
</div>
<div id="questions-and-bugs" class="section level1 unnumbered">
<h1 class="hasAnchor">
<a href="#questions-and-bugs" class="anchor"></a>Questions and bugs</h1>
<p>For bugs, typos, suggestions or other questions, please file an issue in our tracking system (<a href="https://github.com/lgatto/synapter/issues" class="uri">https://github.com/lgatto/synapter/issues</a>) providing as much information as possible, a reproducible example and the output of <code>sessionInfo()</code>.</p>
<p>If you don’t have a GitHub account or wish to reach a broader audience for general questions about proteomics analysis using R, you may want to use the Bioconductor support site: <a href="https://support.bioconductor.org/" class="uri">https://support.bioconductor.org/</a>.</p>
</div>
<div id="introduction" class="section level1">
<h1 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h1>
<p>This document assumes familiarity with standard <em><a href="http://bioconductor.org/packages/synapter">synapter</a></em> pipeline described in <span class="citation">(Bond et al. 2013)</span> and in the package <em><a href="http://bioconductor.org/packages/synapter">synapter</a></em> vignette, available <a href="https://bioconductor.org/packages/release/bioc/vignettes/synapter/inst/doc/synapter.html">online</a> and with <code><a href="../articles/synapter.html">vignette("synapter", package = "synapter")</a></code>.</p>
<p>In this vignette we introduce a new fragment matching feature (see figures <a href="#fig:plotfm22">2</a>, <a href="#fig:plotfmseq">3</a> and <a href="#fig:plotfmid">4</a>) which improves the matching of identification and the quantitation features. After applying the usual <code>synergise1</code> workflow (see <code><a href="../reference/synergise.html">?synergise1</a></code> and <code><a href="../reference/Synapter.html">?Synapter</a></code> for details) a number of multiple matches and possible false unique matches remain that can be deconvoluted by comparing common peaks in the identification fragment peaks and the quantitation spectra.</p>
<p>The example data <code>synobj2</code> used throughout this document is available in the <em><a href="http://bioconductor.org/packages/synapterdata">synapterdata</a></em> package and can be directly load as follows:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(<span class="st">"synapterdata"</span>)
<span class="kw"><a href="http://www.rdocumentation.org/packages/synapterdata/topics/synobj2">synobj2RData</a></span>()</code></pre></div>
<p>In the [next section](:synergise] we describe how <code>synobj2</code> was generated. The test files used in this vignette can be downloaded from <a href="http://proteome.sysbiol.cam.ac.uk/lgatto/synapter/data/" class="uri">http://proteome.sysbiol.cam.ac.uk/lgatto/synapter/data/</a>. The following sections then describe the new fragment matching functionality.</p>
</div>
<div id="running-synergise1" class="section level1">
<h1 class="hasAnchor">
<a href="#running-synergise1" class="anchor"></a>Running <code id="sec:synergise">synergise1</code>
</h1>
<p>One has to run the <code>synergise1</code> workflow before fragment matching can be applied. Please read the general <em><a href="http://bioconductor.org/packages/synapter">synapter</a></em> <a href="https://bioconductor.org/packages/release/bioc/vignettes/synapter/inst/doc/synapter.html">vignette</a> for the general use of <code>synergise1</code>. The additional data needed for the fragment matching procedure are a <code>final_fragment.csv</code> file for the identification run and a <code>Spectrum.xml</code> file for the quantitation run.</p>
<pre><code>## Please find the raw data at:
## http://proteome.sysbiol.cam.ac.uk/lgatto/synapter/data/
library("synapter")

inlist &lt;- list(
  identpeptide = "fermentor_03_sample_01_HDMSE_01_IA_final_peptide.csv.gz",
  identfragments = "fermentor_03_sample_01_HDMSE_01_IA_final_fragment.csv.gz",
  quantpeptide = "fermentor_02_sample_01_HDMSE_01_IA_final_peptide.csv.gz",
  quantpep3d = "fermentor_02_sample_01_HDMSE_01_Pep3DAMRT.csv.gz",
  quantspectra = "fermentor_02_sample_01_HDMSE_01_Pep3D_Spectrum.xml.gz",
  fasta = "S.cerevisiae_Uniprot_reference_canonical_18_03_14.fasta")

synobj2 &lt;- Synapter(inlist, master=FALSE)</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">synobj2 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/synergise.html">synergise1</a></span>(<span class="dt">object=</span>synobj2,
                      <span class="dt">outputdir=</span><span class="kw">tempdir</span>())</code></pre></div>
</div>
<div id="sec:filtfrag" class="section level1">
<h1 class="hasAnchor">
<a href="#sec:filtfrag" class="anchor"></a>Filtering fragments</h1>
<p>This step is optional and allows one to remove low abundance fragments in the spectra using <code>filterFragments</code>. Filtering fragments can remove noise in the spectra and reduce undesired fragment matches. Prior to filtering, the <code>plotCumulativeNumberOfFragments</code> function can be use to visualise the intensity of all fragments. Both functions have an argument <code>what</code> to decide what spectra/fragments to filter/plot. Choose <code>fragments.ident</code> for the identification fragments and <code>spectra.quant</code> for the quantitation fragments.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/Synapter.html">plotCumulativeNumberOfFragments</a></span>(synobj2,
                                <span class="dt">what =</span> <span class="st">"fragments.ident"</span>)</code></pre></div>
<div class="figure">
<img src="fragmentmatching_files/figure-html/filterfragmentsplot-1.png" alt="Cumulative Number of Fragments" width="700"><p class="caption">
Cumulative Number of Fragments
</p>
</div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/Synapter.html">plotCumulativeNumberOfFragments</a></span>(synobj2,
                                <span class="dt">what =</span> <span class="st">"spectra.quant"</span>)</code></pre></div>
<div class="figure">
<img src="fragmentmatching_files/figure-html/filterfragmentsplot-2.png" alt="Cumulative Number of Fragments" width="700"><p class="caption">
Cumulative Number of Fragments
</p>
</div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/Synapter.html">filterFragments</a></span>(synobj2,
                <span class="dt">what =</span> <span class="st">"fragments.ident"</span>,
                <span class="dt">minIntensity =</span> <span class="dv">70</span>)
<span class="kw"><a href="../reference/Synapter.html">filterFragments</a></span>(synobj2,
                <span class="dt">what =</span> <span class="st">"spectra.quant"</span>,
                <span class="dt">minIntensity =</span> <span class="dv">70</span>)</code></pre></div>
</div>
<div id="sec:fragmentmatching" class="section level1">
<h1 class="hasAnchor">
<a href="#sec:fragmentmatching" class="anchor"></a>Fragment matching</h1>
<p>This method, named <code>fragmentMatching</code>, performs the matching of the identification fragments vs the quantitation spectra and counts the number of identical peaks for each combination.</p>
<p>Because the peaks/fragments in the spectra of one run will never be numerically identical to these in another, a tolerance parameter has to be set using the <code>setFragmentMatchingPpmTolerance</code> function. Peaks/Fragments within this tolerance are treated as identical.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/Synapter.html">setFragmentMatchingPpmTolerance</a></span>(synobj2, <span class="dv">25</span>)
<span class="kw"><a href="../reference/Synapter.html">fragmentMatching</a></span>(synobj2)</code></pre></div>
<p>The <code>plotFragmentMatching</code> function illustrates the details of this fragment matching procedure. If it is called without any additional argument every matched pair (fragment vs spectrum) is plotted. One can use the <code>key</code> argument to select a special value in a column (defined by the <code>column</code> argument) of the <code>MatchedEMRTs</code> <code>data.frame</code>. E.g. if one wants to select the fragment matching results with a high number of common peaks, e.g. 28 common peaks:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/plotCrossMatching.html">plotFragmentMatching</a></span>(synobj2,
                     <span class="dt">key =</span> <span class="dv">28</span>,
                     <span class="dt">column =</span> <span class="st">"FragmentMatching"</span>)</code></pre></div>
<div class="figure">
<img src="fragmentmatching_files/figure-html/plotfm22-1.png" alt="Fragment matching for cases with 28 common fragments. The identification data are shown on the top (blue) and the quantitation data are on the bottom (red). Common peaks are displayed in darker colours and highlighted by full points." width="700"><p class="caption">
Fragment matching for cases with 28 common fragments. The identification data are shown on the top (blue) and the quantitation data are on the bottom (red). Common peaks are displayed in darker colours and highlighted by full points.
</p>
</div>
<p>Or, if one is interested in all results for the peptide with the sequence <code>"TALIDGLAQR"</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/plotCrossMatching.html">plotFragmentMatching</a></span>(synobj2,
                     <span class="dt">key =</span> <span class="st">"TALIDGLAQR"</span>,
                     <span class="dt">column =</span> <span class="st">"peptide.seq"</span>)</code></pre></div>
<div class="figure">
<img src="fragmentmatching_files/figure-html/plotfmseq-1.png" alt="Fragment matching for peptide *TALIDGLAQ*." width="700"><p class="caption">
Fragment matching for peptide <em>TALIDGLAQ</em>.
</p>
</div>
<div class="figure">
<img src="fragmentmatching_files/figure-html/plotfmseq-2.png" alt="Fragment matching for peptide *TALIDGLAQ*." width="700"><p class="caption">
Fragment matching for peptide <em>TALIDGLAQ</em>.
</p>
</div>
<p>Maybe the peptide with a special precursor ID looks interesting.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/plotCrossMatching.html">plotFragmentMatching</a></span>(synobj2,
                     <span class="dt">key =</span> <span class="dv">12589</span>,
                     <span class="dt">column =</span> <span class="st">"precursor.leID.ident"</span>)</code></pre></div>
<div class="figure">
<img src="fragmentmatching_files/figure-html/plotfmid-1.png" alt="Fragment matching precursor with *leID* identifier 12589." width="700"><p class="caption">
Fragment matching precursor with <em>leID</em> identifier 12589.
</p>
</div>
<div class="figure">
<img src="fragmentmatching_files/figure-html/plotfmid-2.png" alt="Fragment matching precursor with *leID* identifier 12589." width="700"><p class="caption">
Fragment matching precursor with <em>leID</em> identifier 12589.
</p>
</div>
</div>
<div id="sec:plotperf" class="section level1">
<h1 class="hasAnchor">
<a href="#sec:plotperf" class="anchor"></a>Plot distribution of common peaks</h1>
<p>The <code>plotFragmentMatchingPerformance</code> function can be used to assess the performance of the fragment matching and the result of the filtering procedure (see below) based on the number of common peaks. This function invisibly returns a list with matrices containing true positive, false positive, true negative and false negative matches for the unique and non unique matches EMRT matches, as illustrated in tables <a href="#tab:confusionmatrixunique">1</a> and <a href="#tab:confusionmatrixnonunqiue">2</a>. Both tables could be also generated by <code>fragmentMatchingPerformance</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">m &lt;-<span class="st"> </span><span class="kw"><a href="../reference/Synapter.html">plotFragmentMatchingPerformance</a></span>(synobj2)</code></pre></div>
<div class="figure">
<img src="fragmentmatching_files/figure-html/plotfmperformance-1.png" alt="Number of true/false match peptides for different peak matching thresholds and difference in number of peaks between the first and second (in terms of number of common peaks) possible matches. The former metric is used to filter out possible false positive unique matches while the second is used to filter multiple matches. Empty circles indicate zero peptides." width="700"><p class="caption">
Number of true/false match peptides for different peak matching thresholds and difference in number of peaks between the first and second (in terms of number of common peaks) possible matches. The former metric is used to filter out possible false positive unique matches while the second is used to filter multiple matches. Empty circles indicate zero peptides.
</p>
</div>
<table class="table">
<caption>Number of true positives, false negatives, false positives, false negatives and false discovery rate for a given number of common peaks.</caption>
<thead><tr class="header">
<th align="right">ncommon</th>
<th align="right">tp</th>
<th align="right">fp</th>
<th align="right">tn</th>
<th align="right">fn</th>
<th align="right">all</th>
<th align="right">fdr</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">0</td>
<td align="right">2176</td>
<td align="right">26</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">4034</td>
<td align="right">0.0118074</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="right">1940</td>
<td align="right">5</td>
<td align="right">21</td>
<td align="right">236</td>
<td align="right">2765</td>
<td align="right">0.0025707</td>
</tr>
<tr class="odd">
<td align="right">2</td>
<td align="right">1426</td>
<td align="right">4</td>
<td align="right">22</td>
<td align="right">750</td>
<td align="right">1899</td>
<td align="right">0.0027972</td>
</tr>
<tr class="even">
<td align="right">3</td>
<td align="right">1039</td>
<td align="right">2</td>
<td align="right">24</td>
<td align="right">1137</td>
<td align="right">1370</td>
<td align="right">0.0019212</td>
</tr>
<tr class="odd">
<td align="right">4</td>
<td align="right">759</td>
<td align="right">2</td>
<td align="right">24</td>
<td align="right">1417</td>
<td align="right">1016</td>
<td align="right">0.0026281</td>
</tr>
<tr class="even">
<td align="right">5</td>
<td align="right">569</td>
<td align="right">0</td>
<td align="right">26</td>
<td align="right">1607</td>
<td align="right">780</td>
<td align="right">0.0000000</td>
</tr>
<tr class="odd">
<td align="right">6</td>
<td align="right">414</td>
<td align="right">0</td>
<td align="right">26</td>
<td align="right">1762</td>
<td align="right">600</td>
<td align="right">0.0000000</td>
</tr>
<tr class="even">
<td align="right">7</td>
<td align="right">312</td>
<td align="right">0</td>
<td align="right">26</td>
<td align="right">1864</td>
<td align="right">468</td>
<td align="right">0.0000000</td>
</tr>
<tr class="odd">
<td align="right">8</td>
<td align="right">245</td>
<td align="right">0</td>
<td align="right">26</td>
<td align="right">1931</td>
<td align="right">379</td>
<td align="right">0.0000000</td>
</tr>
<tr class="even">
<td align="right">9</td>
<td align="right">197</td>
<td align="right">0</td>
<td align="right">26</td>
<td align="right">1979</td>
<td align="right">316</td>
<td align="right">0.0000000</td>
</tr>
<tr class="odd">
<td align="right">10</td>
<td align="right">148</td>
<td align="right">0</td>
<td align="right">26</td>
<td align="right">2028</td>
<td align="right">252</td>
<td align="right">0.0000000</td>
</tr>
<tr class="even">
<td align="right">11</td>
<td align="right">116</td>
<td align="right">0</td>
<td align="right">26</td>
<td align="right">2060</td>
<td align="right">203</td>
<td align="right">0.0000000</td>
</tr>
<tr class="odd">
<td align="right">12</td>
<td align="right">94</td>
<td align="right">0</td>
<td align="right">26</td>
<td align="right">2082</td>
<td align="right">171</td>
<td align="right">0.0000000</td>
</tr>
<tr class="even">
<td align="right">13</td>
<td align="right">66</td>
<td align="right">0</td>
<td align="right">26</td>
<td align="right">2110</td>
<td align="right">132</td>
<td align="right">0.0000000</td>
</tr>
<tr class="odd">
<td align="right">14</td>
<td align="right">55</td>
<td align="right">0</td>
<td align="right">26</td>
<td align="right">2121</td>
<td align="right">110</td>
<td align="right">0.0000000</td>
</tr>
</tbody>
</table>
<table class="table">
<caption>Number of true positives, false negatives, false positives, false negatives and false discovery rate for a given difference in number of common peaks between the higest and second highest multiply matching EMRTs in terms of number of common peptides.</caption>
<thead><tr class="header">
<th align="right">deltacommon</th>
<th align="right">tp</th>
<th align="right">fp</th>
<th align="right">tn</th>
<th align="right">fn</th>
<th align="right">all</th>
<th align="right">fdr</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">0</td>
<td align="right">334</td>
<td align="right">72</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">4034</td>
<td align="right">0.1773399</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="right">334</td>
<td align="right">8</td>
<td align="right">64</td>
<td align="right">0</td>
<td align="right">889</td>
<td align="right">0.0233918</td>
</tr>
<tr class="odd">
<td align="right">2</td>
<td align="right">271</td>
<td align="right">4</td>
<td align="right">68</td>
<td align="right">63</td>
<td align="right">698</td>
<td align="right">0.0145455</td>
</tr>
<tr class="even">
<td align="right">3</td>
<td align="right">226</td>
<td align="right">2</td>
<td align="right">70</td>
<td align="right">108</td>
<td align="right">566</td>
<td align="right">0.0087719</td>
</tr>
<tr class="odd">
<td align="right">4</td>
<td align="right">198</td>
<td align="right">1</td>
<td align="right">71</td>
<td align="right">136</td>
<td align="right">501</td>
<td align="right">0.0050251</td>
</tr>
<tr class="even">
<td align="right">5</td>
<td align="right">176</td>
<td align="right">1</td>
<td align="right">71</td>
<td align="right">158</td>
<td align="right">453</td>
<td align="right">0.0056497</td>
</tr>
<tr class="odd">
<td align="right">6</td>
<td align="right">153</td>
<td align="right">1</td>
<td align="right">71</td>
<td align="right">181</td>
<td align="right">397</td>
<td align="right">0.0064935</td>
</tr>
<tr class="even">
<td align="right">7</td>
<td align="right">129</td>
<td align="right">1</td>
<td align="right">71</td>
<td align="right">205</td>
<td align="right">337</td>
<td align="right">0.0076923</td>
</tr>
<tr class="odd">
<td align="right">8</td>
<td align="right">110</td>
<td align="right">1</td>
<td align="right">71</td>
<td align="right">224</td>
<td align="right">294</td>
<td align="right">0.0090090</td>
</tr>
<tr class="even">
<td align="right">9</td>
<td align="right">96</td>
<td align="right">1</td>
<td align="right">71</td>
<td align="right">238</td>
<td align="right">261</td>
<td align="right">0.0103093</td>
</tr>
<tr class="odd">
<td align="right">10</td>
<td align="right">84</td>
<td align="right">1</td>
<td align="right">71</td>
<td align="right">250</td>
<td align="right">232</td>
<td align="right">0.0117647</td>
</tr>
<tr class="even">
<td align="right">11</td>
<td align="right">70</td>
<td align="right">1</td>
<td align="right">71</td>
<td align="right">264</td>
<td align="right">201</td>
<td align="right">0.0140845</td>
</tr>
<tr class="odd">
<td align="right">12</td>
<td align="right">61</td>
<td align="right">1</td>
<td align="right">71</td>
<td align="right">273</td>
<td align="right">180</td>
<td align="right">0.0161290</td>
</tr>
<tr class="even">
<td align="right">13</td>
<td align="right">50</td>
<td align="right">1</td>
<td align="right">71</td>
<td align="right">284</td>
<td align="right">150</td>
<td align="right">0.0196078</td>
</tr>
<tr class="odd">
<td align="right">14</td>
<td align="right">42</td>
<td align="right">1</td>
<td align="right">71</td>
<td align="right">292</td>
<td align="right">130</td>
<td align="right">0.0232558</td>
</tr>
</tbody>
</table>
</div>
<div id="sec:unique" class="section level1">
<h1 class="hasAnchor">
<a href="#sec:unique" class="anchor"></a>Filtering unique matches</h1>
<p>From the left panel on figure <a href="#fig:plotfmperformance">7</a> and table <a href="#tab:confusionmatrixunique">1</a> displaying counts for unique matches one can define filtering values for the unique (this section) and multiple matches (<a href="#sec:nonunique">next section</a>). In the case of uniquely matching EMRTs, one can easily reduce the number of false matches by requiring that true matches must have at least one peak/fragment in common. Clearly this will also remove some true matches. The question is whether you want to rely on matches that have no (or only a few) peaks/fragments in common?</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/Synapter.html">performance</a></span>(synobj2)
<span class="kw"><a href="../reference/Synapter.html">getEMRTtable</a></span>(synobj2)</code></pre></div>
<pre><code>## 
##    0    1    2    3    4    5    6    7   12   14 
##  241 2865  400   64   21    6    5    1    1    1</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/Synapter.html">filterUniqueMatches</a></span>(synobj2, <span class="dt">minNumber =</span> <span class="dv">1</span>)
<span class="kw"><a href="../reference/Synapter.html">performance</a></span>(synobj2)
<span class="kw"><a href="../reference/Synapter.html">getEMRTtable</a></span>(synobj2)</code></pre></div>
<pre><code>## 
##   -1    0    1    2    3    4    5    6    7   12   14 
##  625  241 2240  400   64   21    6    5    1    1    1</code></pre>
</div>
<div id="sec:multiple" class="section level1">
<h1 class="hasAnchor">
<a href="#sec:multiple" class="anchor"></a>Filtering non-unique matches</h1>
<p>The largest benefit of fragment matching is for non unique matches. If we assume that true match have a highest number of common peaks/fragments, we can distinguish correct matches among multiple possible matches that could not resolved before (c.f. section [#sec:plotperf]). To do so, we use the difference of common peaks from the highest to the second highest number in the match group. Assuming two cases with multiple matches. In the first case, we have two possible matches: a match with 7 and a match with 2 fragments in common. In the second ambiguous match, there are a matches with 2 and 1 fragments in common respectively. If we decide to accept a difference of at least 2, our first multiple match case be resolved into a unique match as the difference between the best and second matches is 5 and the best match with 7 common fragments will be upgraded to a unique match.</p>
<p>The right panel of figure <a href="#fig:plotfmperformance">7</a> and table <a href="#tab:confusionmatrixnonunqiue">2</a> can be used to choose a good threshold for the difference in number of common peaks.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/Synapter.html">performance</a></span>(synobj2)
<span class="kw"><a href="../reference/Synapter.html">getEMRTtable</a></span>(synobj2)</code></pre></div>
<pre><code>## 
##   -1    0    1    2    3    4    5    6    7   12   14 
##  625  241 2240  400   64   21    6    5    1    1    1</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/Synapter.html">filterNonUniqueMatches</a></span>(synobj2, <span class="dt">minDelta =</span> <span class="dv">2</span>)
<span class="kw"><a href="../reference/Synapter.html">performance</a></span>(synobj2)
<span class="kw"><a href="../reference/Synapter.html">getEMRTtable</a></span>(synobj2)</code></pre></div>
<pre><code>## 
##   -2   -1    0    1 
##  210  625  241 2529</code></pre>
<p>In this example we rescued 289 unique matches out of the non unique ones.</p>
</div>
<div id="exporting-results" class="section level1">
<h1 class="hasAnchor">
<a href="#exporting-results" class="anchor"></a>Exporting results</h1>
<p>Like in the initial <em><a href="http://bioconductor.org/packages/synapter">synapter</a></em> workflow, it is possible to export the <code>MatchedEMRT</code> results using the <code>writeMatchedEMRTs</code> function. The table has some new columns that correspond to the fragment matching procedure, e.g. <code>FragmentMatching</code>, .</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/Synapter.html">writeMatchedEMRTs</a></span>(synobj2, <span class="dt">file =</span> <span class="st">"MatchedEMRTs.csv"</span>)</code></pre></div>
</div>
<div id="sec:sessionInfo" class="section level1">
<h1 class="hasAnchor">
<a href="#sec:sessionInfo" class="anchor"></a>Session information</h1>
<p>All software and respective versions used to produce this document are listed below.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">sessionInfo</span>()</code></pre></div>
<pre><code>## R version 3.5.1 Patched (2018-08-16 r75161)
## Platform: x86_64-pc-linux-gnu (64-bit)
## Running under: Ubuntu 14.04.5 LTS
## 
## Matrix products: default
## BLAS: /usr/lib/atlas-base/atlas/libblas.so.3.0
## LAPACK: /usr/lib/lapack/liblapack.so.3.0
## 
## locale:
##  [1] LC_CTYPE=en_GB.UTF-8       LC_NUMERIC=C              
##  [3] LC_TIME=en_GB.UTF-8        LC_COLLATE=en_GB.UTF-8    
##  [5] LC_MONETARY=en_GB.UTF-8    LC_MESSAGES=en_GB.UTF-8   
##  [7] LC_PAPER=en_GB.UTF-8       LC_NAME=C                 
##  [9] LC_ADDRESS=C               LC_TELEPHONE=C            
## [11] LC_MEASUREMENT=en_GB.UTF-8 LC_IDENTIFICATION=C       
## 
## attached base packages:
## [1] parallel  stats     graphics  grDevices utils     datasets  methods  
## [8] base     
## 
## other attached packages:
##  [1] synapterdata_1.18.0 synapter_2.5.2      MSnbase_2.7.4      
##  [4] ProtGenerics_1.12.0 BiocParallel_1.14.2 mzR_2.15.2         
##  [7] Rcpp_0.12.18        Biobase_2.40.0      BiocGenerics_0.26.0
## [10] BiocStyle_2.8.2    
## 
## loaded via a namespace (and not attached):
##  [1] vsn_3.48.1            splines_3.5.1         foreach_1.4.4        
##  [4] assertthat_0.2.0      highr_0.7             affy_1.58.0          
##  [7] stats4_3.5.1          yaml_2.2.0            impute_1.54.0        
## [10] pillar_1.3.0          backports_1.1.2       lattice_0.20-35      
## [13] glue_1.3.0            limma_3.36.3          digest_0.6.16        
## [16] RColorBrewer_1.1-2    XVector_0.20.0        qvalue_2.12.0        
## [19] colorspace_1.3-2      htmltools_0.3.6       preprocessCore_1.42.0
## [22] Matrix_1.2-14         plyr_1.8.4            MALDIquant_1.18      
## [25] XML_3.98-1.16         pkgconfig_2.0.2       bookdown_0.7         
## [28] zlibbioc_1.26.0       purrr_0.2.5           scales_1.0.0         
## [31] affyio_1.50.0         cleaver_1.18.0        tibble_1.4.2         
## [34] IRanges_2.14.11       ggplot2_3.0.0         lazyeval_0.2.1       
## [37] survival_2.42-6       magrittr_1.5          crayon_1.3.4         
## [40] memoise_1.1.0         evaluate_0.11         fs_1.2.6             
## [43] doParallel_1.0.11     MASS_7.3-50           xml2_1.2.0           
## [46] BiocInstaller_1.30.0  tools_3.5.1           hms_0.4.2            
## [49] stringr_1.3.1         S4Vectors_0.18.3      munsell_0.5.0        
## [52] bindrcpp_0.2.2        Biostrings_2.48.0     pcaMethods_1.72.0    
## [55] compiler_3.5.1        pkgdown_1.1.0         mzID_1.18.0          
## [58] rlang_0.2.2           grid_3.5.1            iterators_1.0.10     
## [61] rmarkdown_1.10        gtable_0.2.0          codetools_0.2-15     
## [64] multtest_2.36.0       roxygen2_6.1.0        reshape2_1.4.3       
## [67] R6_2.2.2              knitr_1.20            dplyr_0.7.6          
## [70] bindr_0.1.1           commonmark_1.5        rprojroot_1.3-2      
## [73] readr_1.1.1           desc_1.2.0            stringi_1.2.4        
## [76] tidyselect_0.2.4      xfun_0.3</code></pre>
</div>
<div id="references" class="section level1 unnumbered">
<h1 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h1>
<div id="refs" class="references">
<div id="ref-Bond2013">
<p>Bond, Nicholas James, Pavel Vyacheslavovich Shliaha, Kathryn S. Lilley, and Laurent Gatto. 2013. “Improving Qualitative and Quantitative Performance for Ms<span class="math inline">\(^E\)</span>-Based Label Free Proteomics.” <em>Journal of Proteome Research</em> 12 (6). doi:<a href="https://doi.org/10.1021/pr300776t">10.1021/pr300776t</a>.</p>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#foreword">Foreword</a></li>
      <li><a href="#questions-and-bugs">Questions and bugs</a></li>
      <li><a href="#introduction">Introduction</a></li>
      <li><a href="#running-synergise1">Running <code id="sec:synergise">synergise1</code></a></li>
      <li><a href="#sec:filtfrag">Filtering fragments</a></li>
      <li><a href="#sec:fragmentmatching">Fragment matching</a></li>
      <li><a href="#sec:plotperf">Plot distribution of common peaks</a></li>
      <li><a href="#sec:unique">Filtering unique matches</a></li>
      <li><a href="#sec:multiple">Filtering non-unique matches</a></li>
      <li><a href="#exporting-results">Exporting results</a></li>
      <li><a href="#sec:sessionInfo">Session information</a></li>
      <li><a href="#references">References</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Laurent Gatto, Nick J. Bond, Pavel V. Shliaha, Sebastian Gibb.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
</div>

  

  </body>
</html>
