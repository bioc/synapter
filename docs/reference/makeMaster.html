<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Merges final peptide files — makeMaster • synapter</title>

<!-- jquery -->
<script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">


<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script>
<script src="../pkgdown.js"></script>

<!-- mathjax -->
<script src='https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">synapter</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../articles/index.html">Articles</a>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

      <div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Merges final peptide files</h1>
    </div>

    
    <p>This function combines a list of peptide final peptide files into
one single <em>master</em> file that is obtained by merging
the unique peptides from the filtered original peptide files. 
Additionally it can combine multiple final fragment files into a fragment
library.</p>
    

    <pre><span class='fu'>makeMaster</span>(<span class='no'>pepfiles</span>, <span class='no'>fragmentfiles</span>, <span class='kw'>fdr</span> <span class='kw'>=</span> <span class='fl'>0.01</span>, <span class='kw'>method</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='st'>"BH"</span>,
  <span class='st'>"Bonferroni"</span>, <span class='st'>"qval"</span>), <span class='kw'>span.rt</span> <span class='kw'>=</span> <span class='fl'>0.05</span>, <span class='kw'>span.int</span> <span class='kw'>=</span> <span class='fl'>0.05</span>,
  <span class='kw'>maxDeltaRt</span> <span class='kw'>=</span> <span class='fl'>Inf</span>, <span class='kw'>removeNeutralLoss</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='kw'>removePrecursor</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
  <span class='kw'>tolerance</span> <span class='kw'>=</span> <span class='fl'>2.5e-05</span>, <span class='kw'>verbose</span> <span class='kw'>=</span> <span class='fu'>interactive</span>())</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a> Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>pepfiles</th>
      <td><p>A <code>character</code> vector of final peptide file
names to be merged.</p></td>
    </tr>
    <tr>
      <th>fragmentfiles</th>
      <td><p>A <code>character</code> vector of final fragment file
names to be combined into an fragment library. These files should be
from the same runs as the final peptide files used in <code>pepfiles</code>.</p></td>
    </tr>
    <tr>
      <th>fdr</th>
      <td><p>A <code>numeric</code> indicating the peptide false
discovery  rate limit.</p></td>
    </tr>
    <tr>
      <th>method</th>
      <td><p>A <code>character</code> indicating the p-value adjustment to
be used. One of <code>BH</code> (default), <code>Bonferroni</code> or <code>qval</code>.</p></td>
    </tr>
    <tr>
      <th>span.rt</th>
      <td><p>A <code>numeric</code> with the loess span parameter value
to be used for retention time modelling.</p></td>
    </tr>
    <tr>
      <th>span.int</th>
      <td><p>A <code>numeric</code> with the loess span parameter value
to be used for intensity modelling.</p></td>
    </tr>
    <tr>
      <th>maxDeltaRt</th>
      <td><p>A <code>double</code> value that sets a maximum limit for
the retention time deviaton between master and slave run to be included</p></td>
    </tr>
    <tr>
      <th>removeNeutralLoss</th>
      <td><p>A <code>logical</code>, if <code>TRUE</code> peptides with
neutral loss are removed from the fragment library.</p></td>
    </tr>
    <tr>
      <th>removePrecursor</th>
      <td><p>A <code>logical</code>, if <code>TRUE</code> precursor ions are
removed from the fragment spectra.</p></td>
    </tr>
    <tr>
      <th>tolerance</th>
      <td><p>A <code>double</code> value that determines the tolerance used
to look for the precursor ions.</p></td>
    </tr>
    <tr>
      <th>verbose</th>
      <td><p>A <code>logical</code> indicating if information should be
printed out.</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>An instance of class <code>"<a href='MasterPeptides-class.html'>MasterPeptides</a>"</code>.</p>
    
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>The merging process is as follows:</p><ol>
<li><p>Each individual peptide final peptide file is filtered to retain
(i) non-duplicated unique tryptic peptides, (ii) peptides with a
false discovery rate &lt;= <code>fdr</code> and (iii) proteins with a false
positive rate &lt;= <code>fpr</code>.</p></li>
<li><p>The filtered peptide files are ordered (1) according to their total
number of peptides (for example [P1, P2, P3]) and (2) as before with the first
item is positioned last ([P2, P3, P1] in the previous example).
The peptide data are then combined in pairs in these respective orders.
The first one is called the <em>master</em> file.</p></li>
<li><p>For each (master, slave) pair, the slave peptide file
retention times are modelled according to the (original)
master's retention times and slave peptides, not yet present in the
master file are added to the master file.</p></li>
<li><p>The final <em>master</em> datasets, containing their own peptides and
the respective slave specific retention time adjusted peptides are returned
as a <code>MasterPeptides</code> instance.</p></li>
</ol>
    <p>The resulting <code>MasterPeptides</code> instance can be further used
for a complete master vs. peptides/Pep3D analysis, as described in
<code><a href='Synapter.html'>Synapter</a></code>, <code><a href='synergise.html'>synergise</a></code> or using the GUI
(<code><a href='defunct.html'>synapterGUI</a></code>). To do so, it must be serialised (using the
<code>saveRDS</code> function) with a <code>.rds</code> file
extension, to be recognised (and loaded) as a <code>R</code> object.</p>
<p>When several quantitation (or identification) files are combined as a master set
to be mapped back against the inidividual final peptide files,
the second master [P2, P3, P1] is used when analysing the peptide data
that was first selected in the master generation (P1 above).
This is to avoid aligning two identical sets of peptides (those of P1)
and thus not being able to generate a valid retention time model.
This is detected automatically for the user.</p>
<p>The two master peptides dataframes can be exported to disk as
two <code>csv</code> files with <code>writeMasterPeptides</code>. The
<code>MasterPeptides</code> object returned by <code>makeMaster</code> can be
saved to disk (with <code>save</code> or <code>saveRDS</code>) and later reloaded
(with <code>load</code> or <code>readRDS</code>) for further analysis.</p>
<p>The fragment library generation works as follows:</p><ol>
<li><p>Each individual final fragment file is imported and only peptides
present in the <em>master</em> dataset are used.</p></li>
<li><p>The fragments are combined based on their precursor ions.</p></li>
<li><p>The intensities of identical fragments (seen in different runs)
is summed and divided by the summed precursor intensity (of the same
peptide in different runs).</p></li>
<li><p>Afterwards the intensities are normalized to the average precursor
intensity of the different runs.</p></li>
<li><p>Finally a <code>MSnExp</code> object is created.</p></li>
</ol>
    <p>The fragment library dataframe can be exported to disk as
<code>csv</code> file with <code>writeFragmentLibrary</code>.</p>
    
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Shliaha P.V., Bond N. J., Lilley K.S. and Gatto L., in prep.</p>
    
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <p>See the <code><a href='Synapter.html'>Synapter</a></code> class manual page for
detailed information on filtering and modelling and the general
algorithm implemented in the <code>synapter</code> package.</p>
<p>The <code><a href='estimateMasterFdr.html'>estimateMasterFdr</a></code> function allows to control
false dicovery rate when combining several peptide files while
maximising the number of identifications and suggest which
combination of peptide files to use.</p>
<p>The vignette, accessible with <code>synapterGuide()</code>
illustrates a complete pipeline using <code>estimateMasterFdr</code> and
<code>makeMaster</code>.</p>
    

  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>

      <li><a href="#details">Details</a></li>

      <li><a href="#references">References</a></li>

      <li><a href="#see-also">See also</a></li>
          </ul>

    <h2>Author</h2>
    
Laurent Gatto, Sebastian Gibb

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Laurent Gatto, Nick J. Bond, Pavel V. Shliaha, Sebastian Gibb.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://hadley.github.io/pkgdown/">pkgdown</a>.</p>
</div>

      </footer>
   </div>

  </body>
</html>
